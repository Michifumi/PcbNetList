# "PcbNetList"について


## Ａ.概要
+ "PcbNetList.py"は、回路CADのネットリスト： Calay / CR-5000(CCF) / DK-Σ /  MM-2 / Telesis / PADS / Intergraph / KiCAD のフォーマットを双方向に変換できるサブプログラム（関数）です。
+ そのサブプログラムを使って、OrCADのネットリストファイルを入力し、KiCADv4の基板設計ソフトPcbnew用ネットリストを出力できるプログラムを提供する。


## Ｂ.ファイル内容
1. "Calay2Kicad.ipynb" ... OrCADからKiCAD用ネットリスト変換メインソフト
2. "PcbNetList.py"     ... ネット変換用サブプログラム
3. "01_DESIGN1.NET"    ... サンプルCalayネットリスト
4. "01_DESIGN1.csv"    ... サンプル部品情報ファイル
5. "Kicad2Pads.ipynb" ... KiCADネットリストを他ネットPadsへ変換する参考プログラム

 
## Ｃ.動作環境
+ Python3 (Jupyter Notebook) 


## Ｄ.使用方法
1. OrCADのネットリストフォーマットを"Calay"選択し、ネットリストファイルを作成。
2. "Calay2Kicad.ipynb"と同じフォルダにそのファイルをコピーする。
3. "Calay2Kicad.ipynb"をJupyter Notebookでオープンする。
4. 以下の内容にプログラムを変更する。

    import PcbNetList as netlist

    net = netlist.Calay_Read('「OrCAD出力ネットリストファイル名」')

    netlist.Kicad_Write(net, '「出力ファイル名」')

5. プログラムを実行すれば、「出力ファイル名」で指名されたファイルが生成される。この時、生成されたファイルは、部品パッドが各部品最大ピン数のピンヘッダを自動的に割り当てられる。
6. Pcbnewを起動し、そのネットリストをインポートします。　その後、Pcbnewで部品パッドを変更すれば、基板設計できます。
7. この方法は部品一品毎に変更なので部品が多いと面倒です。それで、部番と部品パッド情報をcsvファイルで用意できれば、それを使っても、KiCAD用ネットリストを作成できる。

    それは、上記4.の３行目を

    netlist.Kicad_Write(net, '「出力ファイル名」','「部番と部品パッド情報のcsvファイル名」')
    
    へ変更して実行すると、部品パッドを変更したネットリストファイルが生成される。
    尚、「部番と部品パッド情報のcsvファイル名」は、"01_DESIGN1.csv"を参考にして作成してください。


## Ｅ.その他
1. 他に生成されるファイル"NET.TXT"は、ネットリストが正しく認識されたかを確認する為のものです。
2. Pcbnewで部品パッドを変更する方法は、部品選択後 -> "e"を押して「プロパティ」 -> 「フットプリントの変更」 -> 「フットプリントの表示」です。尚、部品定数は、「部番記号」:「最大ピン数」（例："C:2"）になっていますので、「フットプリントの変更」の「オプション」を使って、抵抗・コンデンサ等をまとめてパッド変換可能です。


## Ｆ.変更履歴
---
2017/11/10   (6th commit)    
1. ネットリストの空白登録を無くす為の処理追加。  
2. "Telesis読み込み"の"$NETS"まで読み飛ばし処理追加。  


---
2017/10/24   (5th commit)    
"PcbNetList.py"のサブプログラムについて、以下の項目を変更した。  
1. KiCADのマクロでも動作するように、文字コードが'UTF-8'である事の宣言追加。    
2. ファイル解析処理中にある改行削除で、'\\n'だけだったのを'\\r'も削除するようにした。    
3. csvファイル処理をNumpyライブラリーからcsvライブラリーへ変更した。  

+ フォルダ："KiCAD_Macro"の中に「KiCADのネットリストをPADSのフォーマットへ変換するKiCADのマクロプログラム」を追加した。  
+ "Kicad2Pads.ipynb" について、他のネットフォーマット出力例をコメント記載した。

---
〜2017/10/20   (〜4th commit)  

+ README.mdの説明文について変更。  

---
2017/10/16   (1st commit)    

---